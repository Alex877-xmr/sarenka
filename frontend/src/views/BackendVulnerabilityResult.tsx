import React from 'react';
import logo from 'static/logo.svg';
import Heading from 'components/atoms/Heading/Heading';
import Input from 'components/atoms/Input/Input';
import SSLInfo from 'components/molecules/SSLInfo/SSLInfro';
import VulnerabilitiesList from 'components/organisms/VulnerabilitiesList/VulnerabilitiesList';
import ResultTemplate from 'templates/VulnerabilityResultTemplate';

const dummyData = {
  ssl: {
    host: '267.102.41.2',
    subjectDN: 'CN=en.slovakiatatry.sk',
    issuerDN: 'C=US, O=Let’s Encrypt. CN=Let’s Encrypt Authority X3',
    serial: '28920623547880476758717595455198746335398775',
    validity: '2020-03-10 12:45:34 to 2020-06-08 12:45:34 (90 days, 0:00:00)',
    names: 'en.slovakiatatry.sk',
    sslv3: true,
    exportDhe: false,
    exportRsa: false,
    dheSupport: true,
  },
  portList: [
    {
      port: 8080,
      title: 'Example website title',
      foundTechnologies: 'Django',
      vulnerabilitiesList: [
        {
          cveId: 'CVE-2019-16223',
          cweId: '79',
          publishDate: '2019-09-11',
          updateDate: '2019-09-12',
          complexity: 'Medium',
          access: 'Remote',
          score: 3.5,
          auth: 'Single system',
          description:
            'In WordPress before 5.2.3, validation and sanitization of a URL in wp_validate_redirect in wp-includes/pluggable.php could lead to an open redirect.',
        },
        {
          cveId: 'CVE-2019-16220',
          cweId: '601',
          publishDate: '2019-09-11',
          updateDate: '2019-09-12',
          complexity: 'Medium',
          access: 'Remote',
          score: 7.5,
          auth: 'Single system',
          description:
            'In WordPress before 5.2.3, validation and sanitization of a URL in wp_validate_redirect in wp-includes/pluggable.php could lead to an open redirect.',
        },
      ],
    },
    {
      port: 8088,
      title: 'Example website title',
      foundTechnologies: 'Django',
      vulnerabilitiesList: [
        {
          cveId: 'CVE-2019-16223',
          cweId: '79',
          publishDate: '2019-09-11',
          updateDate: '2019-09-12',
          complexity: 'Medium',
          access: 'Remote',
          score: 3.5,
          auth: 'Single system',
          description:
            'In WordPress before 5.2.3, validation and sanitization of a URL in wp_validate_redirect in wp-includes/pluggable.php could lead to an open redirect.',
        },
        {
          cveId: 'CVE-2019-16220',
          cweId: '601',
          publishDate: '2019-09-11',
          updateDate: '2019-09-12',
          complexity: 'Medium',
          access: 'Remote',
          score: 7.5,
          auth: 'Single system',
          description:
            'In WordPress before 5.2.3, validation and sanitization of a URL in wp_validate_redirect in wp-includes/pluggable.php could lead to an open redirect.',
        },
      ],
    },
  ],
};

type Props = {
  onSubmit?(event: React.FormEvent<HTMLFormElement>): void;
};

const VulnerabilityResultTemplate = ({ onSubmit }: Props) => {
  const { ssl, portList } = dummyData;
  return (
    <ResultTemplate
      search={
        <>
          <img src={logo} alt="App logo." />
          <Heading regularfont>Search for errors on your domain</Heading>
          <form onSubmit={onSubmit}>
            <Input
              id="search"
              name="search"
              type="text"
              placeholder="Type website address"
              search
            />
          </form>
        </>
      }
      result={
        <>
          <SSLInfo
            host={ssl.host}
            subjectDN={ssl.subjectDN}
            issuerDN={ssl.issuerDN}
            serial={ssl.serial}
            validity={ssl.validity}
            names={ssl.names}
            sslv3={ssl.sslv3}
            exportDhe={ssl.exportDhe}
            exportRsa={ssl.exportRsa}
            dheSupport={ssl.dheSupport}
          />
          {portList.map((item) => {
            const {
              port,
              title,
              foundTechnologies,
              vulnerabilitiesList,
            } = item;
            return (
              <VulnerabilitiesList
                key={port}
                port={port}
                title={title}
                foundTechnologies={foundTechnologies}
                vulnerabilitiesList={vulnerabilitiesList}
              />
            );
          })}
        </>
      }
    />
  );
};

export default VulnerabilityResultTemplate;
